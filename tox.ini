[tox]
isolated_build = true
env_list = 
    py{314,313,312,311,310}-unit,
    py{314,313,312,311,310}-smoke,
    format,
    lint-only

labels =
    tests = py{314,313,312,311,310}-unit, py{314,313,312,311,310}-smoke
    style = format, lint-only

[testenv]
allowlist_externals = poetry
commands_pre =
    poetry install --with dev


[testenv:py{314,313,312,311,310}-unit]
description = Fast tests that never launch a browser
commands =
    poetry run pytest -m unit --cov=src --cov-report=term-missing --cov-report=xml --junitxml=junit.xml

[testenv:py{314,313,312,311,310}-smoke]
description = Minimal browser-launch tests
commands =
    poetry run pytest -m smoke --cov=src --cov-report=term-missing --cov-report=xml --junitxml=junit.xml

[testenv:py314]
description = Run tests with Python 3.14
basepython = python3.14


[testenv:py313]
description = Run tests with Python 3.13
basepython = python3.13

[testenv:py312]
description = Run tests with Python 3.12
basepython = python3.12

[testenv:py311]
description = Run tests with Python 3.11
basepython = python3.11

[testenv:py310]
description = Run tests with Python 3.10
basepython = python3.10

[testenv:test-all]
description = Run all Python versions in parallel
deps = tox
commands = tox -p auto

[testenv:format]
description = Auto-format code with Ruff
basepython = python3.14
commands =
    poetry run ruff format

[testenv:lint-only]
description = Run linting and type checking only
basepython = python3.14
commands =
    poetry run ruff check src/ tests/
    poetry run mypy src/ tests/